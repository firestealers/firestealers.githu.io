---
layout: post
description: 简单又有趣的linux命令
author: jesse
---

![ncat](/assets/images/blogs/nc-ncat-command-examples-Linux-Systems.jpg){:zoom=40%}

### 简介
`ncat`或者说`nc`是一款功能类似 `cat`的工具(concatnate简写)，但是是用于网络的。  
它是一款拥有多种功能的`命令行`工具，可以用来在网络上读、写以及重定向数据。  
它被设计成可以被脚本或其他程序调用的可靠的后端工具。  
同时由于它能创建任意所需的连接，因此也是一个很好的网络调试工具。  

`ncat`或`nc`既可以是一个端口扫描工具，也可以是一个安全工具，又能是一个监测工具，还可以作为一个简单的TCP代理。 由于有这么多的功能，它被誉为是网络界的瑞士军刀。  
这个工具是每个系统管理员都应该知道并且掌握它的。  

大部分Debian的发行版都内置了ncat，如果没有安装的话，参考下面的CentOS的安装命令：  

```bash
[root@daohuo ~]# yum install nmap-ncat -y
```

系统管理员可以用它来审计系统安全，用它来找出开放的端口然后保护这些端口。  
管理员还能用它作为客户端来审计 Web 服务器、telnet 服务器、邮件服务器等，通过 nc 我们可以控制发送的每个字符，也可以查看对方的回应。  
我们也可以让它去捕获客户端送出的数据，来知道它们做了什么。  
>
本文主要讲解ncat的使用.  
以下进入正题:

### 例子1:） 监听入站连接
使用`-l`参数，可以使`ncat`进入监听模式。完整的命令如下：  

    $ ncat -l port_number

比如：
```bash
[root@daohuo ~]# ncat -l 8080
```
这会在8080端口监听所有的入站连接。

### 例子2:）连接到远程系统
要使用`ncat`连接到远程系统，我们可以使用下面的命令
```bash
$ ncat hostname port_number
```
比如说：
```bash
[root@daohuo ~]# ncat 192.168.1.100 8080
```
这时服务器192.168.1.100的8080端口与本机已经建立了连接（前提是服务器开放此端口）。假设说是tomcat服务器，我们可以GET主页：
```
GET / HTTP/1.1
```
或
```
GET /index.jsp HTTP/1.1
```
### 例子3:）连接UDP端口
默认情况下，`ncat`会自动连接TCP端口。我们可以给定参数`-u`来使它连接一个udp端口。
```bash
$ ncat -l -u 1234
```
现在使用命令查看1234端口的监听情况：
```bash
[root@daohuo ~]# netstat -tunlp | grep 1234
udp        0      0 0.0.0.0:1234        0.0.0.0:*          27728/ncat          
udp6       0      0 :::1234             :::*               27728/ncat  
```
假设我们想发送或者说测试某个远程主机 UDP 端口的连通性，我们可以使用下面命令：
```
$ ncat -v -u hostname udp_port_number
```
例如：
```bash
[root@daohuo ~]# ncat -v -u localhost 1234
Ncat: Version 7.50 ( https://nmap.org/ncat )
Ncat: Connected to 127.0.0.1:1234.
```
### 例子4:）聊天工具
`ncat`也可以被用来当做一个聊天工具，我们可以配置服务器去监听一个特定端口，远程服务器将通过这个端口建立TCP连接，从而开始发送信息。
在服务器端运行：
```bash
$ ncat -l 1234
```
在能访问这台服务器的一台机器上运行：
```bash
$ ncat your_host_name 1234
```
然后就可以开始发送信息啦。它们会在你的终端上显示。
### 例子5:）使用ncat发送网络文件
`ncat`还能用来在系统间传输文件，虽然这并不推荐，因为绝大多数系统默认都安装了`ssh/scp`。不过如果你恰好使用一个没有`ssh/scp`的系统的话，你可以用`ncat`来作最后的努力。  
在要接受文件的机器上开启ncat监听模式：
```bash
$ ncat -l 1234 > file.txt
```
现在在要发送文件的机器上运行：
```bash
$ ncat receive_file_host 1234 --send-only < sent_data.txt
```
在这里，sent_data.txt是被发送的文件。--send-only参数会在文件传输完成后即刻关闭连接。如果不添加这个参数，你不知道什么时候你的文件会传送完成，而且需要手动Ctrl+C手动关闭连接。  
>
原文说用这个方法还可以拷贝整个磁盘分区，有风险，但并没有说风险来自哪里。  
我认为这个传输文件过程必须非常干净，接收方开放的端口只能由发送方访问，但这是很难做到的。不能保证互联网上的没有恶意的脚本小子去做端口扫描，数据包一旦不经意间发送到这个端口，整个文件数据流会被破坏。  
可能这是作者未说的风险之一吧。 

### 例子6:）创建系统后门
`ncat`命令还可以用来在系统中创建后门，并且这种技术也确实被黑客大量使用。 为了保护我们的系统，我们需要知道它是怎么做的。 创建后门的命令为：
```bash
$ ncat -l 10000 -e /bin/bash
```
`-e`选项连接了bash到10000端口。现在客户端可以连接到服务器这个端口，启动服务器的bash shell:
```bash
$ ncat remote_host 10000
```
然后是命令行操作啦。
### 例子7:）端口转发
我们也可以用`ncat`，使用`-c`选项做端口转发，要实现这一点的语法如下：
```
$ ncat -u -l 80 -c 'ncat -u -l 8080'
```
现在所有的通向80端口的连接会被转发到8080端口啦。
>
通过这个命令，你可以不使用nginx，不修改tomcat的默认端口就可以将你的tomcat项目通过默认的HTTP协议80端口访问啦。

### 例子8:）设置连接超时
`ncat`的监听模式会一直运行，除非你手动停止它或完成一次连接任务。但我们用`-w`来设置超时时间。
```bash
$ ncat -w 10 hostname port_number
```
这会让连接在建立连接10秒后断开。不过只能在客户端上启用这个，而不是服务器端。

### 例子9:）使用`-k`选项保持持续ncat监听
当客户端从服务器断开连接后，过一段时间服务器也会停止继续监听。但我们可以使用`-k`选项强制服务器继续监听：
```bash
$ ncat -l -k 8080
```
现在就算客户端的连接断开，服务器也会继续待命。
  
>
自此就结束啦，如有疑问或翻译不妥当的或任何想说的，都可以在下方留言或者发送信息、邮件哦。   
原文: <https://www.linuxtechi.com/nc-ncat-command-examples-linux-systems/>
